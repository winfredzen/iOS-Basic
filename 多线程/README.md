# 多线程

进程：是指在系统中正在运行的一个应用程序。每个进程是独立的，每个进程均运行在其专用且受保护的内存空间内

线程：1一个进程要想执行任务，必须得有线程（每1个进程至少要有1个线程）。一个进程（程序）的所有任务都在线程中执行

线程的串行：1个线程中任务的执行是串行的

+ 如果要在1个线程中执行多个任务，那么只能一个一个地按顺序执行这些任务
+ 也就是说，在同一时间内，1个线程只能执行1个任务


**进程和线程的比较**

+ 线程是CPU调用(执行任务)的最小单位。
+ 进程是CPU分配资源和调度的单位。
+ 一个程序可以对应多个进程，一个进程中可以有多个线程，但至少要有一个线程。
+ 同一个进程内的线程共享进程的资源。

## 多线程简介

**什么是多线程？**

1个进程中可以开启多条线程，每条线程可以并行（同时）执行不同的任务。多线程可以提高程序的效率

**多线程原理**

+ 同一时间，CPU只能处理1条线程，只有1条线程在工作（执行）
+ 多线程并发（同时）执行，其实是CPU快速地在多条线程之间调度（切换）
+ 如果CPU调度线程的时间足够快，就造成了多线程并发执行的假象

使用多线程编程可保证应用程序的响应性能

多线程编程可能发生的问题

1. 多个线程更新相同的资源会导致数据的不一致（数据竞争）
2. 停止等待事件的线程会导致多个线程相互持续等待（死锁）
3. 使用太多线程会消耗大量的内存。CPU会在N多线程之间调度，CPU会累死，消耗大量的CPU资源

**主线程**

一个iOS程序运行后，默认会开启1条线程，称为“主线程”或“UI线程”

主线程的作用：

+ 显示\刷新UI界面
+ 处理UI事件（比如点击事件、滚动事件、拖拽事件等）

获取主线程

```
NSThread *mainThread = [NSThread mainThread];
```

获取当前线程

```
NSThread *currentThread  = [NSThread currentThread];
```

判断是否是主线程

```
    //类方法
    BOOL isMainThreadA = [NSThread isMainThread];
    //对象方法
    BOOL isMainThreadB = [currentThread isMainThread];
```


**iOS中的多线程**

+ pthread
+ NSThread
+ GCD
+ NSOperation










